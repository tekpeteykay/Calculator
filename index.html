<!DOCTYPE html>
<html>
<head>
    <title>Casual Worker Calculator 2025</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background: #f4f4f4;
        }
        h1 {
            text-align: center;
            margin-bottom: 5px;
        }
        .profile {
            text-align: center;
            margin-bottom: 15px;
        }
        .profile img {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            object-fit: cover;
            border: 2px solid #007BFF;
        }
        .container {
            background: #fff;
            padding: 20px;
            border-radius: 10px;
            max-width: 800px;
            margin: auto;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }
        label, input {
            display: block;
            margin: 5px 0;
        }
        button {
            padding: 8px 15px;
            margin-top: 10px;
            background: #007BFF;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        table {
            width: 100%;
            margin-top: 15px;
            border-collapse: collapse;
        }
        th, td {
            padding: 8px;
            text-align: center;
            border-bottom: 1px solid #ddd;
        }
        th {
            background: #007BFF;
            color: white;
        }
        .delete-btn {
            background: red;
            color: white;
            border: none;
            padding: 5px 8px;
            border-radius: 4px;
            cursor: pointer;
        }
        .total-box {
            margin-top: 20px;
            background: #e6f7ff;
            padding: 10px;
            border-radius: 5px;
        }
        .archive-btn {
            background: orange;
            margin-left: 5px;
        }
    </style>
</head>
<body>

<div class="container">
    <div class="profile">
        <input type="text" id="userName" placeholder="Enter your name" onchange="updateProfile()">
        <input type="file" id="userPhoto" accept="image/*" onchange="previewPhoto(event)">
        <div id="profileDisplay"></div>
    </div>

    <h1>Casual Worker Calculator 2025</h1>

    <label>Select Date:</label>
    <input type="date" id="workDate">

    <label>Clock In Time:</label>
    <input type="time" id="clockIn">
    <label>Clock Out Time:</label>
    <input type="time" id="clockOut">
    <button onclick="addDay()">Add Day</button>
    <button class="archive-btn" onclick="archiveMonth()">Archive Month</button>

    <table>
        <thead>
            <tr>
                <th>Date</th>
                <th>Break Taken</th>
                <th>Hours Worked</th>
                <th>Base Pay (£)</th>
                <th>Holiday Pay (£)</th>
                <th>Total (£)</th>
                <th>Action</th>
            </tr>
        </thead>
        <tbody id="records"></tbody>
    </table>

    <div class="total-box">
        <p><strong>Total Hours:</strong> <span id="totalHours">0</span></p>
        <p><strong>Total Base Pay:</strong> £<span id="totalBase">0.00</span></p>
        <p><strong>Total Holiday Pay:</strong> £<span id="totalHoliday">0.00</span></p>
        <p><strong>Grand Total:</strong> £<span id="grandTotal">0.00</span></p>
    </div>
</div>

<script>
    const hourlyRate = 13.85;
    const holidayRate = 1.67;
    let days = [];

    function updateProfile() {
        const name = document.getElementById("userName").value;
        const display = document.getElementById("profileDisplay");
        if (name) {
            display.innerHTML = `<p><strong>${name}</strong></p>`;
        }
    }

    function previewPhoto(event) {
        const file = event.target.files[0];
        if (file) {
            const reader = new FileReader();
            reader.onload = function(e) {
                document.getElementById("profileDisplay").innerHTML = 
                    `<img src="${e.target.result}" alt="Profile Photo"><p><strong>${document.getElementById("userName").value}</strong></p>`;
            };
            reader.readAsDataURL(file);
        }
    }

    function calculateHours(start, end) {
        let startTime = new Date(`1970-01-01T${start}:00`);
        let endTime = new Date(`1970-01-01T${end}:00`);
        let diff = (endTime - startTime) / (1000 * 60 * 60);

        if (diff < 0) {
            endTime.setDate(endTime.getDate() + 1);
            diff = (endTime - startTime) / (1000 * 60 * 60);
        }

        let breakTime = 0;
        if (diff >= 10) {
            breakTime = 1;
            diff -= 1;
        } else if (diff >= 8) {
            breakTime = 0.5;
            diff -= 0.5;
        }

        return { hours: diff, breakTime };
    }

    function addDay() {
        const date = document.getElementById("workDate").value;
        const clockIn = document.getElementById("clockIn").value;
        const clockOut = document.getElementById("clockOut").value;

        if (!date || !clockIn || !clockOut) {
            alert("Please enter date, clock in, and clock out times.");
            return;
        }

        const { hours, breakTime } = calculateHours(clockIn, clockOut);
        const basePay = hours * hourlyRate;
        const holidayPay = hours * holidayRate;
        const totalPay = basePay + holidayPay;
        const breakLabel = breakTime === 1 ? "1 hour" : (breakTime === 0.5 ? "30 mins" : "No break");

        days.push({ date, breakLabel, hours, basePay, holidayPay, totalPay });
        sortDays();
        updateTable();
    }

    function sortDays() {
        days.sort((a, b) => new Date(a.date) - new Date(b.date));
    }

    function deleteDay(index) {
        if (confirm("Are you sure you want to delete this entry?")) {
            days.splice(index, 1);
            updateTable();
        }
    }

    function archiveMonth() {
        if (days.length === 0) {
            alert("No data to archive.");
            return;
        }
        const monthData = days.map(day => 
            `${day.date} - ${day.hours.toFixed(2)} hrs | £${day.basePay.toFixed(2)} base | £${day.holidayPay.toFixed(2)} holiday | £${day.totalPay.toFixed(2)} total`
        ).join("\n");

        const blob = new Blob([monthData], { type: "text/plain" });
        const link = document.createElement("a");
        link.href = URL.createObjectURL(blob);
        link.download = `Work_Hours_${new Date().toLocaleDateString().replace(/\//g, "-")}.txt`;
        link.click();

        days = [];
        updateTable();
    }

    function updateTable() {
        let recordsHTML = "";
        let totalHours = 0, totalBase = 0, totalHoliday = 0, grandTotal = 0;

        days.forEach((day, index) => {
            recordsHTML += `
                <tr>
                    <td>${new Date(day.date).toLocaleDateString()}</td>
                    <td>${day.breakLabel}</td>
                    <td>${day.hours.toFixed(2)}</td>
                    <td>£${day.basePay.toFixed(2)}</td>
                    <td>£${day.holidayPay.toFixed(2)}</td>
                    <td>£${day.totalPay.toFixed(2)}</td>
                    <td><button class="delete-btn" onclick="deleteDay(${index})">Delete</button></td>
                </tr>
            `;
            totalHours += day.hours;
            totalBase += day.basePay;
            totalHoliday += day.holidayPay;
            grandTotal += day.totalPay;
        });

        document.getElementById("records").innerHTML = recordsHTML;
        document.getElementById("totalHours").textContent = totalHours.toFixed(2);
        document.getElementById("totalBase").textContent = totalBase.toFixed(2);
        document.getElementById("totalHoliday").textContent = totalHoliday.toFixed(2);
        document.getElementById("grandTotal").textContent = grandTotal.toFixed(2);
    }
</script>

</body>
</html>
